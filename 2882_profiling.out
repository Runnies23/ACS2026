Switching to group 'render' and re-executing...
True
Checking GPU Availability...
Torch version: 2.9.1+rocm7.1.1.git351ff442
Is ROCm/CUDA available?: True
Device count: 1
/var/spool/slurm/slurmd/job02882/slurm_script: line 43: module: command not found
-------------------------------------------
Processing dataset: unitree_z1_stackbox
2026-02-07 14:49:47.952795: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2026-02-07 14:49:47.988396: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2026-02-07 14:49:47.988450: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2026-02-07 14:49:47.990311: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2026-02-07 14:49:47.998799: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2026-02-07 14:49:48.616271: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[rank: 0] Global seed set to 123
INFO:root:[INFO] Start Inference
INFO:root:init valueable: 0.006462s
/mnt/ASC1664/miniconda3/envs/unifolm-wma/lib/python3.10/site-packages/kornia/feature/lightglue.py:44: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  @torch.cuda.amp.custom_fwd(cast_inputs=torch.float32)
INFO:mainlogger:LatentVisualDiffusion: Running in v-prediction mode
INFO:root:load models: 1.507797s
Traceback (most recent call last):
  File "/mnt/ASC1664/unifolm-wma-0-dual_run_workspace/unifolm-world-model-action/scripts/evaluation/world_model_interaction.py", line 932, in <module>
    run_inference(args, gpu_num, rank)
  File "/mnt/ASC1664/unifolm-wma-0-dual_run_workspace/unifolm-world-model-action/scripts/evaluation/world_model_interaction.py", line 511, in run_inference
    model = instantiate_from_config(config.model)
  File "/mnt/ASC1664/unifolm-wma-0-dual_run_workspace/unifolm-world-model-action/src/unifolm_wma/utils/utils.py", line 36, in instantiate_from_config
    return get_obj_from_str(config["target"])(**config.get("params", dict()))
  File "/mnt/ASC1664/unifolm-wma-0-dual_run_workspace/unifolm-world-model-action/src/unifolm_wma/models/ddpms.py", line 1957, in __init__
    super().__init__(*args, **kwargs)
  File "/mnt/ASC1664/unifolm-wma-0-dual_run_workspace/unifolm-world-model-action/src/unifolm_wma/models/ddpms.py", line 905, in __init__
    super().__init__(conditioning_key=conditioning_key, *args, **kwargs)
  File "/mnt/ASC1664/unifolm-wma-0-dual_run_workspace/unifolm-world-model-action/src/unifolm_wma/models/ddpms.py", line 155, in __init__
    self.model = DiffusionWrapper(wma_config, conditioning_key)
  File "/mnt/ASC1664/unifolm-wma-0-dual_run_workspace/unifolm-world-model-action/src/unifolm_wma/models/ddpms.py", line 2469, in __init__
    self.diffusion_model = instantiate_from_config(diff_model_config)
  File "/mnt/ASC1664/unifolm-wma-0-dual_run_workspace/unifolm-world-model-action/src/unifolm_wma/utils/utils.py", line 36, in instantiate_from_config
    return get_obj_from_str(config["target"])(**config.get("params", dict()))
  File "/mnt/ASC1664/unifolm-wma-0-dual_run_workspace/unifolm-world-model-action/src/unifolm_wma/modules/networks/wma_model.py", line 458, in __init__
    TemporalTransformer(model_channels,
  File "/mnt/ASC1664/unifolm-wma-0-dual_run_workspace/unifolm-world-model-action/src/unifolm_wma/modules/attention.py", line 633, in __init__
    self.transformer_blocks = nn.ModuleList([
  File "/mnt/ASC1664/unifolm-wma-0-dual_run_workspace/unifolm-world-model-action/src/unifolm_wma/modules/attention.py", line 634, in <listcomp>
    BasicTransformerBlock(inner_dim,
  File "/mnt/ASC1664/unifolm-wma-0-dual_run_workspace/unifolm-world-model-action/src/unifolm_wma/modules/attention.py", line 431, in __init__
    self.attn1 = attn_cls(
  File "/mnt/ASC1664/unifolm-wma-0-dual_run_workspace/unifolm-world-model-action/src/unifolm_wma/modules/attention.py", line 112, in __init__
    if XFORMERS_IS_AVAILBLE and temporal_length is None:
NameError: name 'XFORMERS_IS_AVAILBLE' is not defined
All jobs completed!
